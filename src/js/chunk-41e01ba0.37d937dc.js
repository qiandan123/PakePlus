(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41e01ba0"],{"210a":function(t,e,i){"use strict";i("3595")},3595:function(t,e,i){},"37ad":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100vh","min-height":"768px",width:"100vw","min-width":"1024px"}},[i("div",{staticStyle:{flex:"1",display:"flex",padding:"10px","box-sizing":"border-box",gap:"10px"}},[i("div",{staticStyle:{width:"150px","min-width":"150px","max-width":"200px",display:"flex","align-items":"center"}},[i("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"出料口一上层",name:"1"}}),i("el-tab-pane",{attrs:{label:"出料口一下层",name:"2"}}),i("el-tab-pane",{attrs:{label:"出料口一闸门",name:"3"}}),i("el-tab-pane",{attrs:{label:"出料口二闸门",name:"4"}}),i("el-tab-pane",{attrs:{label:"出料口二上层",name:"5"}}),i("el-tab-pane",{attrs:{label:"出料口二下层",name:"6"}}),i("el-tab-pane",{attrs:{label:"提升机拉料轴",name:"7"}}),i("el-tab-pane",{attrs:{label:"A库位升降机",name:"8"}}),i("el-tab-pane",{attrs:{label:"B库位升降机",name:"9"}}),i("el-tab-pane",{attrs:{label:"出入口",name:"10"}})],1)],1),i("div",{staticClass:"table-container",staticStyle:{flex:"1",overflow:"hidden"}},[i("div",{staticStyle:{width:"100%","text-align":"center"}},[i("div",{staticStyle:{display:"inline-flex","align-items":"center",gap:"10px",padding:"10px"}},[i("h3",{staticStyle:{margin:"0",color:"white","font-size":"16px"}},[t._v(" 当前位置[mm] ")]),i("el-input",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"当前位置",disabled:!0},model:{value:t.currentSpeed,callback:function(e){t.currentSpeed=e},expression:"currentSpeed"}})],1)]),i("div",{staticClass:"table-wrap"},[i("el-table",{ref:"tableRef",staticStyle:{"font-size":"16px","text-align":"center"},attrs:{"row-key":"id",height:t.tableHeight,border:"",data:t.tableData,"cell-style":{padding:"0",height:"40.7px",lineHeight:"50px"}}},[i("el-table-column",{attrs:{prop:"index",width:"130"},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",[i("div",{staticClass:"form-label"},[t._v("序号")])])]},proxy:!0}])}),i("el-table-column",{attrs:{prop:"triggerButton",label:"触发按钮"},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",[i("div",{staticClass:"form-label"},[t._v("触发按钮")])])]},proxy:!0},{key:"default",fn:function(e){return[i("div",{staticClass:"button-wrapper"},[i("el-button",{directives:[{name:"longpress",rawName:"v-longpress"}],ref:"autoSizeButton",staticStyle:{width:"100%",height:"100%"},attrs:{type:"primary"},nativeOn:{mousedown:function(i){return t.triggerEvent(e.row.index,e.row.inputValue)},mouseup:function(i){return t.triggerEvent1(e.row.index,e.row.inputValue)}}},[i("span",{staticStyle:{"font-size":"18px","line-height":"normal"}},[t._v(" MX-"+t._s(e.$index+1)+"触发 ")])])],1)]}}])}),i("el-table-column",{attrs:{prop:"inputValue",label:"输入框"},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",[i("div",{staticClass:"form-label"},[t._v("输入框")])])]},proxy:!0},{key:"default",fn:function(e){return[i("div",[i("el-input",{staticClass:"custom-input",attrs:{placeholder:"0.00"},on:{focus:function(i){return t.updateParam(e.row)}},model:{value:e.row.inputValue,callback:function(i){t.$set(e.row,"inputValue",i)},expression:"scope.row.inputValue"}})],1)]}}])}),i("el-table-column",{attrs:{prop:"colorBox",label:"颜色区分框",align:"center","header-align":"center"},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",[i("div",{staticClass:"form-label"},[t._v("颜色区分框")])])]},proxy:!0},{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-bottom":"-2px","margin-top":"5px","line-height":"normal","align-items":"center","justify-content":"center",display:"inline-block",width:"30px",height:"30px","border-radius":"3px"},style:{backgroundColor:t.row.colorBox}})]}}])}),i("el-table-column",{attrs:{prop:"textDisplay",label:"文字显示框",width:"220"},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",[i("div",{staticClass:"form-label"},[t._v("文字显示框")])])]},proxy:!0},{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.description)+" ")]}}])})],1)],1)])]),i("div",{staticClass:"pallet-inventory-update"},[i("el-form",{ref:"form",staticClass:"form-wrap custom-form",staticStyle:{"font-size":"16px"},attrs:{model:t.form,"label-width":"250px"}},[t.activeName<8?i("div",{staticClass:"form-row"},[i("el-form-item",{staticStyle:{flex:"1","max-width":"48%"},attrs:{label:t.pageFormText.upperLimit1}},[i("div",{staticClass:"input-with-unit"},[i("el-input",{staticClass:"custom-input",staticStyle:{height:"40px"},attrs:{placeholder:"0.00"},model:{value:t.mainUpLimit,callback:function(e){t.mainUpLimit=e},expression:"mainUpLimit"}}),i("span",{staticClass:"unit-text"},[t._v("mm")])],1)]),i("el-form-item",{staticStyle:{flex:"1","max-width":"48%","margin-left":"2%"},attrs:{label:t.pageFormText.upperLimit2}},[i("div",{staticClass:"input-with-unit"},[i("el-input",{staticClass:"custom-input",staticStyle:{height:"40px"},attrs:{placeholder:"0.00"},model:{value:t.followUpLimit,callback:function(e){t.followUpLimit=e},expression:"followUpLimit"}}),i("span",{staticClass:"unit-text"},[t._v("mm")])],1)])],1):t._e(),t.activeName<8?i("div",{staticClass:"form-row"},[i("el-form-item",{staticStyle:{flex:"1","max-width":"48%"},attrs:{label:t.pageFormText.lowerLimit1}},[i("div",{staticClass:"input-with-unit"},[i("el-input",{staticClass:"custom-input",attrs:{placeholder:"0.00"},model:{value:t.mainDownLimit,callback:function(e){t.mainDownLimit=e},expression:"mainDownLimit"}}),i("span",{staticClass:"unit-text"},[t._v("mm")])],1)]),i("el-form-item",{staticStyle:{flex:"1","max-width":"48%","margin-left":"2%"},attrs:{label:t.pageFormText.lowerLimit2}},[i("div",{staticClass:"input-with-unit"},[i("el-input",{staticClass:"custom-input",attrs:{placeholder:"0.00"},model:{value:t.followDownLimit,callback:function(e){t.followDownLimit=e},expression:"followDownLimit"}}),i("span",{staticClass:"unit-text"},[t._v("mm")])],1)])],1):t._e(),t.activeName>=8?i("div",{staticClass:"form-row"},[i("el-form-item",{staticStyle:{flex:"1","max-width":"48%"},attrs:{label:t.pageFormText.zUpLimit}},[i("div",{staticClass:"input-with-unit"},[i("el-input",{staticClass:"custom-input",attrs:{placeholder:"0.00"},model:{value:t.mainDownLimit,callback:function(e){t.mainDownLimit=e},expression:"mainDownLimit"}}),i("span",{staticClass:"unit-text"},[t._v("mm")])],1)]),i("el-form-item",{staticStyle:{flex:"1","max-width":"48%","margin-left":"2%"},attrs:{label:t.pageFormText.zDownLimit}},[i("div",{staticClass:"input-with-unit"},[i("el-input",{staticClass:"custom-input",attrs:{placeholder:"0.00"},model:{value:t.followDownLimit,callback:function(e){t.followDownLimit=e},expression:"followDownLimit"}}),i("span",{staticClass:"unit-text"},[t._v("mm")])],1)])],1):t._e()])],1),i("u-modal",{ref:"modal_updateparam",class:"cw-style-width cw-style-height cw-style-border-style cw-style-border-color cw-style-border-left-width cw-style-border-width cw-style-border-right-width cw-style-border-top-width cw-style-border-bottom-width",staticStyle:{"--cw-style-width":"640px","--cw-style-height":"450px","--cw-style-border-style":"solid","--cw-style-border-color":"#4e5969","--cw-style-border-left-width":"0px","--cw-style-border-right-width":"0px","--cw-style-border-top-width":"0px","--cw-style-border-bottom-width":"0px","--modal-dialog-background-color":"#4e5969","border-top-width":"0px","border-left-width":"0px","border-right-width":"0px","border-bottom-width":"0px","border-style":"solid","--update-key":"ins6","border-color":"#4e5969",width:"640px",height:"450px","--modal-dialog-width":"640px"},attrs:{size:"auto","is-heading-slot-empty":!0},scopedSlots:t._u([{key:"foot",fn:function(){return[i("u-linear-layout",{ref:"linear_layout_2W_4",attrs:{justify:"center"}},[i("u-button",{directives:[{name:"longpress",rawName:"v-longpress"}],ref:"button_2W_37",class:"cw-style-width cw-style-height cw-style-padding-top cw-style-padding cw-style-font-size",staticStyle:{"--cw-style-width":"160px","--cw-style-height":"64px","--cw-style-padding-top":"13px","--cw-style-font-size":"26px",width:"160px",height:"64px","padding-top":"13px","--update-key":"o84i","font-size":"26px","--button-color-hover":"#a3a3a4","--button-color":"#ffffff","--custom-start":"auto",background:"linear-gradient(180deg, #a8b8ca 0%, #6b7886 100%)"},attrs:{text:"取 消",color:"default"},on:{mouseup:function(e){return t.cancelUpdate(e)}}}),i("u-button",{directives:[{name:"longpress",rawName:"v-longpress"}],ref:"button_2W_36",class:"cw-style-width cw-style-height cw-style-padding-top cw-style-padding cw-style-font-size",staticStyle:{"--cw-style-width":"160px","--cw-style-height":"64px","--cw-style-padding-top":"13px","--cw-style-font-size":"26px","padding-top":"13px","--update-key":"lkdq",width:"160px",height:"64px","font-size":"26px","--custom-start":"auto",background:"linear-gradient(180deg, #4db1ff 0%, #1375ed 100%)"},attrs:{color:"primary",text:"确 定"},on:{mouseup:function(e){return t.confirmUpdate(e)}}})],1)]},proxy:!0},{key:"body",fn:function(){return[i("u-linear-layout",{ref:"linear_layout_2W_6",class:"cw-style-width cw-style-height",staticStyle:{"--cw-style-width":"640px","--cw-style-height":"150px",width:"640px",height:"150px"},attrs:{direction:"horizontal",wrap:!0,mode:"flex",justify:"start",alignment:"center"}},[i("u-form",{key:"form_2W_1",ref:"form_2W_1",class:"cw-style-width",staticStyle:{"--cw-style-width":"100%",width:"100%","--form-item-label-width":"130px"},attrs:{widthStretch:"false"}},[i("u-form-item",{ref:"form_item_2W_1",class:"cw-style-width",staticStyle:{"--cw-style-width":"100%",width:"100%"},attrs:{required:!0,layout:"center"},scopedSlots:t._u([{key:"label",fn:function(){return[i("u-text",{ref:"text_2W_88",class:"cw-style-font-size cw-style-color",staticStyle:{"--cw-style-font-size":"20px","--cw-style-color":"#ffffff","font-size":"20px",color:"#ffffff"},attrs:{text:t.$utils["ToString"]("nasl.core.String",t.updateText)}})]},proxy:!0}])},[i("u-input",{ref:"input_2W_2",class:"cw-style-width cw-style-height cw-style-font-size",staticStyle:{"--cw-style-width":"100%","--cw-style-height":"48px","--cw-style-font-size":"20px",width:"100%",height:"48px","--update-key":"e542","font-size":"20px"},attrs:{placeholder:t.$utils["ToString"]("nasl.core.String","请输入")+t.$utils["ToString"]("nasl.core.String",t.updateText),value:t.selectedParam.inputValue},on:{"update:value":function(e){return t.$set(t.selectedParam,"inputValue",e)},focus:t.onNumberInputFocus}})],1)],1)],1)]},proxy:!0},{key:"title",fn:function(){return[i("u-text",{ref:"text_2W_86",class:"cw-style-font-size cw-style-color",staticStyle:{"--cw-style-font-size":"20px","--cw-style-color":"#ffffff",color:"#ffffff","font-size":"20px"},attrs:{text:"设定值修改"}})]},proxy:!0},{key:"heading",fn:function(){},proxy:!0}])}),i("KeyboardDialog",{attrs:{input:t.selectedParam.inputValue,mode:"number",decimalLength:2},on:{"update:input":function(e){return t.$set(t.selectedParam,"inputValue",e)}},model:{value:t.showKeyboardDialog,callback:function(e){t.showKeyboardDialog=e},expression:"showKeyboardDialog"}})],1)},s=[],o=(i("14d9"),i("e9f5"),i("7d54"),i("2f62")),l=i("65b2"),n=i("8617"),r={components:{KeyboardDialog:n["a"]},computed:{...Object(o["b"])(["getUserResource","getRouteData"]),userResource(){return this.getUserResource},routeData(){return this.getRouteData}},data(){return{positionKey:"",positionList:[],updateText:"",selectedParam:{inputValue:""},showKeyboardDialog:!1,triggerKey:"",triggerValue:null,mainUpLimit:void 0,mainDownLimit:void 0,followUpLimit:void 0,followDownLimit:void 0,zUpLimit:void 0,zDownLimit:void 0,currentSpeed:void 0,readFlag:[],handPositionSubscription:null,tableHeight:void 0,pageFormText:{upperLimit1:"主轴扭矩保护上限",upperLimit2:"从轴扭矩保护上限",lowerLimit1:"主轴扭矩保护下限",lowerLimit2:"从轴扭矩保护下限",zUpLimit:"Z轴扭矩上限",zDownLimit:"Z轴扭矩下限"},activeName:localStorage.getItem("activeName")||"1",tableData:[],form:{upperLimit1:"",upperLimit2:"",lowerLimit1:"",lowerLimit2:""}}},watch:{activeName:{handler(t){let e=window.localStorage.getItem("webSocketConnected");while(!e)e=window.localStorage.getItem("webSocketConnected");""!==t&&(localStorage.setItem("activeName",t),e&&(console.log("当前页发生变化或初始化:",t),this.handPositionSubscription&&(this.handPositionSubscription.unsubscribe(),this.handPositionSubscription=null),this.$wsSend("/app/getPositionPage",{type:"start",page:t}),this.handPositionSubscription=this.$wsSubscribe("/topic/getManualPositioning",async e=>{try{const i=e.body,a=JSON.parse(i);await this.updateTableData(a,t),console.log("111111111111111111111111当前页:",this.activeName)}catch(i){this.$toast.error("获取手动定位订阅信息失败: "+i.message)}})))},immediate:!0}},methods:{async confirmUpdate(){let t=[{tagName:this.positionKey,loop:this.positionList.loopNum[this.selectedParam.index-1],value:this.selectedParam.inputValue}],e=await l["a"].post("/gw/screenDev/v1/sys/machine/processTrayBatch",t);200===e.data.code?(this.$toast.success("修改成功"),await(this.$refs&&this.$refs["modal_updateparam"]&&this.$refs["modal_updateparam"].close&&this.$refs["modal_updateparam"].close())):this.$toast.error("修改失败")},async cancelUpdate(){await(this.$refs&&this.$refs["modal_updateparam"]&&this.$refs["modal_updateparam"].close&&this.$refs["modal_updateparam"].close())},onNumberInputFocus(){this.showKeyboardDialog=!0},async updateParam(t){this.selectedParam=t,this.updateText=null===this.selectedParam.description||""===this.selectedParam.description?"待修改值":this.selectedParam.description,console.log("3333333333333333333333333"),await(this.$refs&&this.$refs["modal_updateparam"]&&this.$refs["modal_updateparam"].open&&this.$refs["modal_updateparam"].open())},async triggerEvent(t,e){let i=[{tagName:this.triggerKey,loop:this.triggerValue.loopNum[t-1],value:1}],a=await l["a"].post("/gw/screenDev/v1/sys/machine/processTrayBatch",i);200===a.data.code?this.$toast.success("触发成功"):this.$toast.error(this.$utils["ToString"]("nasl.core.String","触发失败"))},async triggerEvent1(t,e){let i=[{tagName:this.triggerKey,loop:this.triggerValue.loopNum[t-1],value:0}],a=await l["a"].post("/gw/screenDev/v1/sys/machine/processTrayBatch",i);200===a.data.code?this.$toast.success("触发成功"):this.$toast.error(this.$utils["ToString"]("nasl.core.String","触发失败"))},async getDescriptionList(t){return t.includes("(")&&t.includes(")")?(t=t.substring(t.indexOf("(")+1,t.indexOf(")")),t.split(",")):[]},async updateTableData(t){let e=Object.keys(t),i=localStorage.getItem("activeName")||"1",a=e[0].substring(e[0].lastIndexOf("_")+1);if(null!==a&&a!==i)return;this.triggerKey="HMI_bMoveHmi_911_"+i,this.triggerValue=t[this.triggerKey];let s=t["HMI_rActPos_911_"+i];this.currentSpeed=s.plcValue[0],i<8?(this.mainUpLimit=t["HMI_TorqueUpLimit_main_911_"+i].plcValue[0],this.mainDownLimit=t["HMI_TorqueLowLimit_main_911_"+i].plcValue[0],this.followUpLimit=t["HMI_TorqueUpLimit_follow_911_"+i].plcValue[0],this.followDownLimit=t["HMI_TorqueLowLimit_follow_911_"+i].plcValue[0]):(this.zUpLimit=t["HMI_TorqueUpLimit_911_"+i].plcValue[0],this.zDownLimit=t["HMI_TorqueLowLimit_911_"+i].plcValue[0]),this.positionKey="HMI_rMovePosition_911_"+i,this.positionList=t[this.positionKey];let o=this.positionList.plcValue,l=this.positionList.description,n=await this.getDescriptionList(l),r=t["HMI_bInPosition_911_"+i],c=r.plcValue,p=[];for(let d=0;d<o.length;d++){let t={index:d+1,triggerButton:"MX-"+(d+1)+"触发",inputValue:o[d],colorBox:"1"===c[d]?"green":"#FFA500"};null!=n&&d<n.length?t.description=n[d]:t.description="",p.push(t)}this.tableData=[...p]},handleClick(t,e){console.log(t,e)}},mounted(){this.$nextTick(()=>{this.tableHeight=window.innerHeight-320,this.$nextTick(()=>{const t=this.$refs.autoSizeButton;t&&t.length>0&&t.forEach(t=>{const e=t.$el,i=e.offsetWidth,a=e.offsetHeight,s=Math.min(i/6,.7*a);e.style.fontSize=Math.max(10,Math.min(s,16))+"px"})})})},beforeDestroy(){this.$wsSend("/app/getPositionPage",{type:"stop"}),this.handPositionSubscription&&(this.handPositionSubscription.unsubscribe(),this.handPositionSubscription=null),localStorage.removeItem("activeName")}},c=r,p=(i("210a"),i("2877")),d=Object(p["a"])(c,a,s,!1,null,"2291c162",null);e["default"]=d.exports}}]);