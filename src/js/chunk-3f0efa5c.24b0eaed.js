(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f0efa5c"],{"61f1":function(t,e,a){},"6a5a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("u-linear-layout",{ref:"linear_layout_kt_1",attrs:{gap:"none"}},[a("u-linear-layout",{ref:"linear_layout_kt_10",class:"cw-style-height cw-style-margin-top cw-style-margin",staticStyle:{"--cw-style-height":"auto","--cw-style-margin-top":"12px","margin-top":"12px","--update-key":"1q39",overflow:"auto",height:"100vh"},attrs:{direction:"horizontal",wrap:!0}},[a("u-linear-layout",{ref:"linear_layout_kt_11",class:"cw-style-width",staticStyle:{"--cw-style-width":"100%",width:"100%"},attrs:{direction:"horizontal",wrap:!0}},[a("u-divider",{ref:"divider_1",staticStyle:{"margin-top":"0px"},attrs:{dashed:"a",contentPosition:"center"}},[a("u-text",{ref:"text_965",staticStyle:{"--cw-style-font-size":"20px","--cw-style-color":"#ffffff",color:"#ffffff","font-size":"20px"},attrs:{text:"订单行列 ",display:"inline"}})],1),a("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"-20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.isChecked,expression:"isChecked"}],staticStyle:{width:"32px",height:"32px","margin-right":"10px","accent-color":"#1a41ee"},attrs:{type:"checkbox",id:"filterCheckbox"},domProps:{checked:Array.isArray(t.isChecked)?t._i(t.isChecked,null)>-1:t.isChecked},on:{change:[function(e){var a=t.isChecked,s=e.target,i=!!s.checked;if(Array.isArray(a)){var r=null,n=t._i(a,r);s.checked?n<0&&(t.isChecked=a.concat([r])):n>-1&&(t.isChecked=a.slice(0,n).concat(a.slice(n+1)))}else t.isChecked=i},t.filterData]}}),a("label",{staticStyle:{"font-size":"24px",color:"white"}},[t._v("按照指令名称过滤 "+t._s(t.insName))])]),a("u-linear-layout",{ref:"linear_layout_kt_12",attrs:{direction:"horizontal",wrap:!0}},[[a("div",{staticClass:"container"},[a("el-table",{ref:"tableView",staticStyle:{width:"100%",height:"430px",overflow:"auto"},attrs:{data:t.filteredData,stripe:!1,"highlight-current-row":!0,"row-class-name":t.getRowClassName,"header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"}},on:{"row-click":t.handleRowClick}},[a("el-table-column",{staticStyle:{"border-collapse":"collapse",border:"1px solid black"},attrs:{prop:"gridId",label:"指令"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",[t._v(" 指令 "),a("el-input",{staticStyle:{width:"100%",padding:"0 5px","margin-top":"5px"},attrs:{placeholder:"搜索指令"},on:{input:t.handleSearch,focus:function(e){return t.onTestDataInputFocus("gridSearch",t.gridSearch)}},model:{value:t.gridSearch,callback:function(e){t.gridSearch=e},expression:"gridSearch"}})],1)]},proxy:!0},{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.instructionName))])]}}])}),a("el-table-column",{staticStyle:{"border-collapse":"collapse",border:"1px solid black"},attrs:{prop:"goodsDescr",label:"货物"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",[t._v(" 货物 "),a("el-input",{staticStyle:{width:"100%",padding:"0 5px","margin-top":"5px"},attrs:{placeholder:"搜索货物"},on:{input:t.handleSearch,focus:function(e){return t.onTestDataInputFocus("goodsDescrSearch",t.goodsDescrSearch)}},model:{value:t.goodsDescrSearch,callback:function(e){t.goodsDescrSearch=e},expression:"goodsDescrSearch"}})],1)]},proxy:!0},{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.goodsCode))])]}}])}),a("el-table-column",{staticStyle:{"border-collapse":"collapse",border:"1px solid black"},attrs:{prop:"description",label:"描述"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",[t._v(" 描述 "),a("el-input",{staticStyle:{width:"100%",padding:"0 5px","margin-top":"5px"},attrs:{placeholder:"搜索描述"},on:{input:t.handleSearch,focus:function(e){return t.onTestDataInputFocus("descriptionSearch",t.descriptionSearch)}},model:{value:t.descriptionSearch,callback:function(e){t.descriptionSearch=e},expression:"descriptionSearch"}})],1)]},proxy:!0},{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.description))])]}}])}),a("el-table-column",{staticStyle:{"border-collapse":"collapse",border:"1px solid black"},attrs:{prop:"inventory",label:"数量"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",[t._v(" 数量 "),a("el-input-number",{staticStyle:{width:"100%",padding:"0 5px","margin-top":"5px"},attrs:{placeholder:"搜索数量","controls-position":"right",min:0},on:{input:t.handleSearch,focus:function(e){return t.onTestDataInputFocus("inventorySearch",t.inventorySearch)}},model:{value:t.inventorySearch,callback:function(e){t.inventorySearch=e},expression:"inventorySearch"}})],1)]},proxy:!0},{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.requiredQuantity))])]}}])}),a("el-table-column",{staticStyle:{"border-collapse":"collapse",border:"1px solid black"},attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",[t._v(" 状态 "),a("el-input",{staticStyle:{width:"100%",padding:"0 5px","margin-top":"5px"},attrs:{placeholder:"搜索状态"},on:{input:t.handleSearch,focus:function(e){return t.onTestDataInputFocus("statusSearch",t.statusSearch)}},model:{value:t.statusSearch,callback:function(e){t.statusSearch=e},expression:"statusSearch"}})],1)]},proxy:!0},{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.statusDescription(e.row)))])]}}])})],1)],1)]],2),a("u-linear-layout",{ref:"bottom_buttons",class:"cw-style-height cw-style-background-color",staticStyle:{"--cw-style-height":"100px","--cw-style-background-color":"#2c3e50",height:"100px","background-color":"#2c3e50"},attrs:{direction:"horizontal",wrap:!0}},[a("u-grid-layout-row",{ref:"grid_layout_row_2W_3",class:"cw-style-height cw-style-margin-left cw-style-margin cw-style-margin-bottom cw-style-margin-top cw-style-margin-right",staticStyle:{"--cw-style-height":"31vh","--cw-style-margin-left":"0px","--cw-style-margin-bottom":"8px","--cw-style-margin-top":"0px","--cw-style-margin-right":"0px","margin-left":"0px","--update-key":"a2yg","margin-right":"0px","margin-top":"0px","margin-bottom":"8px",height:"31vh"},attrs:{repeat:24}},[a("div",{staticClass:"status-container"},[a("el-card",{staticClass:"status-card",attrs:{"body-style":{padding:"10px"}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("货物注意事项：")]),a("span",{staticClass:"value"},[t._v(t._s(t.attention))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("子码 1：")]),a("span",{staticClass:"value"},[t._v(t._s(t.subCode1))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("子码 2：")]),a("span",{staticClass:"value"},[t._v(t._s(t.subCode2))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("物料状态：")]),a("span",{staticClass:"value"},[t._v(t._s(t.materialStatus))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("包装类别：")]),a("span",{staticClass:"value"},[t._v(t._s(t.packagingType))])])])],1)],1),a("el-card",{staticClass:"status-card",attrs:{"body-style":{padding:"10px"}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("到期日：")]),a("span",{staticClass:"value"},[t._v(t._s(t.expiryDate))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("承载单元：")]),a("span",{staticClass:"value"},[t._v(t._s(t.loadUnit))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("请求注意事项：")]),a("span",{staticClass:"value"},[t._v(t._s(t.requestAttention))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("属性 1：")]),a("span",{staticClass:"value"},[t._v(t._s(t.attribute1))])])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info-item"},[a("span",{staticClass:"label"},[t._v("属性 2：")]),a("span",{staticClass:"value"},[t._v(t._s(t.attribute2))])])])],1)],1)],1),a("u-linear-layout",{ref:"action_buttons",class:"cw-style-width cw-style-height",staticStyle:{"--cw-style-width":"33%","--cw-style-height":"100px",width:"20%",height:"100px"},attrs:{direction:"vertical",wrap:!0}},[a("u-linear-layout",{ref:"top_buttons",class:"cw-style-height",staticStyle:{"--cw-style-height":"50px",height:"100%",width:"200%"},attrs:{direction:"horizontal",wrap:!0}},[a("el-button",{directives:[{name:"longpress",rawName:"v-longpress"}],staticStyle:{width:"45%",height:"60%","margin-left":"10px","margin-top":"20px"},attrs:{type:"primary"},on:{click:t.button_run}},[t._v(" 执行 ")])],1)],1)],1)],1)],1)],1),a("KeyboardDialog",{attrs:{input:t.trayNum},on:{"update:input":function(e){t.trayNum=e}},model:{value:t.showLetterKeyboardDialog,callback:function(e){t.showLetterKeyboardDialog=e},expression:"showLetterKeyboardDialog"}})],1)},i=[],r=(a("f4f9"),a("450d"),a("c2cc")),n=a.n(r),o=(a("7a0f"),a("0f6c")),c=a.n(o),l=(a("b8e0"),a("a4c4")),d=a.n(l),u=(a("e9f5"),a("d866"),a("910d"),a("f665"),a("ab43"),a("1e70"),a("79a4"),a("c1a1"),a("8b00"),a("a4e7"),a("1e5a"),a("72c3"),a("8617")),h=a("65b2");const p={mounted(){document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)},beforeDestroy(){document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp)},methods:{async onKeyDown(t){},async onKeyUp(t){}}};var y={components:{KeyboardDialog:u["a"],"el-card":d.a,"el-row":c.a,"el-col":n.a},mixins:[p],props:{gridId:{type:Number,default:function(){}}},watch:{trayNum(t){"gridSearch"===this.currentType?this.gridSearch=t:"goodsCodeSearch"===this.currentType?this.goodsCodeSearch=t:"descriptionSearch"===this.currentType?this.descriptionSearch=t:"inventorySearch"===this.currentType?this.inventorySearch=t:"statusSearch"===this.currentType&&(this.statusSearch=t),this.handleSearch()},gridId:{handler(t){this.$emit("update:gridId",t)}}},data(){return{isChecked:!1,insId:0,insName:"",descriptionSearch:"",statusSearch:"",currentType:"",trayNum:void 0,showLetterKeyboardDialog:!1,data:[],filteredData:[],gridSearch:void 0,goodsCodeSearch:void 0,inventorySearch:void 0,locationSearch:void 0,dataOld:this.$genInitFromSchema("nasl.collection.List<app.structures.TrayPickingByGridDto>",void 0),isClean:!1,goodsDescrSearch:void 0,"private-data-source-cache":new Map,instructionStatus:"",selectedName:"",attention:"",subCode1:"",subCode2:"",materialStatus:"",materialStatusData:"",packagingType:"",packagingTypeData:"",expiryDate:"",loadUnit:"",requestAttention:"",attribute1:"",attribute2:""}},computed:{},meta:{title:"订单行列",crumb:void 0,crumbI18n:void 0,first:void 0,auth:void 0},methods:{statusDescription(t){return t.rowStatus?t.rowStatus.includes("E")&&!t.rowStatus.includes("W")?"执行":t.rowStatus.includes("E")&&t.rowStatus.includes("W")?"局部执行":t.rowStatus.includes("W")?"等待":t.rowStatus.includes("I")?"请求":"未知状态":""},getRowClassName({row:t,rowIndex:e}){return t.isSearch?"search-row":""},handleRowClick(t,e,a){this.$refs.tableView.setCurrentRow(t),this.selectedName=t.instructionName,this.instructionStatus=t.rowStatus,this.attention=t.precautions,this.subCode1=t.sub1Code,this.subCode2=t.sub2Code,this.materialStatus=t.goodsStatus,this.packagingType=t.packagingTypeValue,this.expiryDate=t.expirationDateDate,this.loadUnit=t.trayCode,this.requestAttention=t.reqNote,this.attribute1=t.attributes1,this.attribute2=t.attributes1;const s=this.materialStatusData.find(e=>e.itemValue===t.goodsStatus);s&&(this.materialStatus=s.itemText);const i=this.packagingTypeData.find(e=>e.itemValue===t.packagingTypeValue);i&&(this.packagingType=i.itemText)},handleSearch(){this.filteredData=this.data.filter(t=>{let e=!0;return this.gridSearch&&!t.instructionName.includes(this.gridSearch)&&(e=!1),this.goodsDescrSearch&&!t.goodsCode.includes(this.goodsDescrSearch)&&(e=!1),this.descriptionSearch&&!t.description.includes(this.descriptionSearch)&&(e=!1),this.inventorySearch&&t.requiredQuantity!==this.inventorySearch&&(e=!1),this.statusSearch&&!t.rowStatus.includes(this.statusSearch)&&(e=!1),e})},async loadData(){try{const t=await h["a"].get("/rest/queue/list",{params:{equipmentCode:1}});if(!t.data.result||!Array.isArray(t.data.result))return void(this.data=[]);const e=Array.from(new Set(t.data.result.map(t=>t.instructionName))),a=e.join(","),s=await h["a"].get("/rest/v2/api/instruction/list",{params:{instructionNameList:a,equipmentCode:1}}),i=s.data.result,r=i.map(t=>t.instructionName);if(console.log(r),null===r||""===r||0===r.length)return;const n=await h["a"].get("/rest/v2/api/instructionRow/list",{params:{instructionNameList:r.join(",")}});this.data=n.data.result,this.filteredData=this.data}catch(a){throw console.error("请求失败:",a),a}let t=await h["a"].get("/rest/v2/api/dict/list/packaging_type");this.packagingTypeData=t.data.result;let e=await h["a"].get("/rest/v2/api/dict/list/goods_status");this.materialStatusData=e.data.result},async button_run(t){if(null==this.selectedName||""===this.selectedName)return void await this.$toast.warning(this.$utils["ToString"]("nasl.core.String","请选择要执行的指令！"));if(this.instructionStatus.includes("E")&&!this.instructionStatus.includes("W")&&!this.instructionStatus.includes("I"))return void await this.$toast.error(this.$utils["ToString"]("nasl.core.String","该指令正在执行中"));let e=this.category;if("V"===e)try{await h["a"].post("/rest/instructionIn",{params:{instructionNamaList:this.selectedName,delAllFlag:!0}})}catch(a){throw console.error("请求失败:",a),a}else if("P"===e)try{await h["a"].post("/rest/instructionOut",{params:{instructionNamaList:this.selectedName,delAllFlag:!0}})}catch(a){throw console.error("请求失败:",a),a}else try{await h["a"].post("/rest/instructionStock",{params:{instructionNamaList:this.selectedName,delAllFlag:!0}})}catch(a){throw console.error("请求失败:",a),a}},filterData(){this.isChecked&&""!==this.insName.trim()?this.filteredData=this.data.filter(t=>t.instructionName===this.insName):this.filteredData=this.data},onTestDataInputFocus(t,e){this.currentType=t,this.trayNum=e,this.showLetterKeyboardDialog=!0},async clearSearch(){this.gridSearch=void 0,this.goodsCodeSearch=void 0,this.inventorySearch=void 0,this.locationSearch=void 0,this.goodsDescrSearch=void 0},async showGridByTray_created(t){this.insId=this.$route.query.id,this.insName=this.$route.query.name,this.$global.frontendVariables.pageName="1.4.3 |  订单行列",await(async()=>{await(async()=>{const t=document.documentElement;t.style.setProperty("--table-view-head-title-sortable-hover","#0050AB")})(),await this.loadData()})()},__isShallowEqualArray(t,e){return t.length===e.length&&t.every((t,a)=>{const s=e[a];return typeof t===typeof s&&("string"===typeof t?t===s:"object"===typeof t&&["item","index","rowIndex","columnIndex","value"].every(e=>t[e]===s[e]))})},__getDataSourceCacheFn(t,e=[]){if(!e.length)return this["private-data-source-cache"].get(t);for(let[a,s]of this["private-data-source-cache"].entries())if(this.__isShallowEqualArray(a,[t,...e]))return s},__setDataSourceCacheFn(t,e=[],a){e.length?this["private-data-source-cache"].set([t,...e],a):this["private-data-source-cache"].set(t,a)},__getOrCreateDataSource(t,e=[],a){let s=this.__getDataSourceCacheFn(t,e);return s||(s=a,this.__setDataSourceCacheFn(t,e,s)),s},onSync_State(t,e,a){this[`${t}_state_${e}`]=a}},async created(){await this.showGridByTray_created()}},g=y,m=(a("70d1"),a("2877")),f=Object(m["a"])(g,s,i,!1,null,"1b20cd40",null);e["default"]=f.exports},"70d1":function(t,e,a){"use strict";a("61f1")}}]);